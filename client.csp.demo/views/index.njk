{% extends "_base.njk" %}

{% block body %}
Hello CSP Demonstrator! Use the options below to test injection payloads:
<dl>
  <dt>Reflected:</dt>
  <dd> 
  <form method="POST" action="/">
    <input type="text" name="unsafeReflection" value="" /><button type="submit">Exploit</button>
  </form>
  </dd>
  <dt>DOM-based ('self' must be whitelisted as a script-src)</dt>
  <dd>
    <input type="text" name="unsafeDom" value="" /><button id="exploitUnsafeDom">Exploit</button>
  </dd>
</dl>
<div id="payload">
{{ payload | safe }}
</div>
<script src="/main.js"></script>
{% endblock %}